var SiteCreateWizard=function(){function e(e){this.$root=e,this.firstPanel="#panelPurpose",this.firstPanel="#panelPurpose",this.mode=$("#SiteCreateWizard").data("mode"),this.initEvents()}return e.prototype.getRadioValue=function(e,n){var a=this.$root.find("fieldset."+e).find("input:checked");return a.length>0?a.val():n},e.prototype.getWizardState=function(){return{wording:this.getRadioValue("wording",1),singleMotion:this.getRadioValue("singleMotion",0),motionsInitiatedBy:this.getRadioValue("motionWho",1),motionsDeadlineExists:this.getRadioValue("motionDeadline",0),motionsDeadline:this.$root.find("fieldset.motionDeadline .date input").val(),motionScreening:this.getRadioValue("motionScreening",1),needsSupporters:this.getRadioValue("needsSupporters",0),minSupporters:this.$root.find("input.minSupporters").val(),hasAmendments:this.getRadioValue("hasAmendments",1),amendSinglePara:this.getRadioValue("amendSinglePara",0),amendmentInitiatedBy:this.getRadioValue("amendmentWho",1),amendmentDeadlineExists:this.getRadioValue("amendmentDeadline",0),amendmentDeadline:this.$root.find("fieldset.amendmentDeadline .date input").val(),amendScreening:this.getRadioValue("amendScreening",1),hasComments:this.getRadioValue("hasComments",1),hasAgenda:this.getRadioValue("hasAgenda",0),openNow:this.getRadioValue("openNow",0),title:$("#siteTitle").val(),organization:$("#siteOrganization").val(),subdomain:$("#siteSubdomain").val(),contact:$("#siteContact").val()}},e.prototype.showPanel=function(e){this.data=this.getWizardState(),console.log(this.data);var n=e.data("tab");this.$root.find(".wizard .steps li").removeClass("active"),this.$root.find(".wizard .steps ."+n).addClass("active"),this.$activePanel&&this.$activePanel.removeClass("active").addClass("inactive"),e.addClass("active").removeClass("inactive"),this.$activePanel=e;try{var a=window.location.hash=="#"+e.attr("id");""!=window.location.hash&&"#"!=window.location.hash||"#"+e.attr("id")!=this.firstPanel||(a=!0),a||(console.log("change"),window.location.hash="#"+e.attr("id").substring(5))}catch(e){console.log(e)}},e.prototype.getNextPanel=function(){switch(this.data=this.getWizardState(),this.$activePanel.attr("id")){case"panelPurpose":return"#panelSingleMotion";case"panelSingleMotion":return 1==this.data.singleMotion?"#panelHasAmendments":"#panelMotionWho";case"panelMotionWho":return 1==this.data.motionsInitiatedBy?"#panelHasAmendments":"#panelMotionDeadline";case"panelMotionDeadline":return"#panelMotionScreening";case"panelMotionScreening":return"#panelNeedsSupporters";case"panelNeedsSupporters":return"#panelHasAmendments";case"panelHasAmendments":return 1==this.data.hasAmendments?"#panelAmendSinglePara":"#panelComments";case"panelAmendSinglePara":return"#panelAmendWho";case"panelAmendWho":return 1==this.data.amendmentInitiatedBy?"#panelComments":"#panelAmendDeadline";case"panelAmendDeadline":return"#panelAmendScreening";case"panelAmendScreening":return"#panelComments";case"panelComments":return 1==this.data.singleMotion?"#panelOpenNow":"#panelAgenda";case"panelAgenda":return"#panelOpenNow";case"panelOpenNow":return"#panelSiteData"}},e.prototype.initEvents=function(){var e=this,n=this.$root;this.$activePanel=null,this.data=this.getWizardState(),n.find("input").change(function(){e.data=e.getWizardState()}),n.find(".radio-label input").change(function(){var e=$(this).parents("fieldset").first();e.find(".radio-label").removeClass("active");var n=e.find(".radio-label input:checked");n.parents(".radio-label").first().addClass("active")}).trigger("change"),n.find("fieldset.wording input").change(function(){var e=n.find("fieldset.wording input:checked").data("wording-name");n.removeClass("wording_motion").removeClass("wording_manifesto").addClass("wording_"+e)}).trigger("change"),n.find(".input-group.date").each(function(){var e=$(this);e.datetimepicker({locale:e.find("input").data("locale")})}),n.find(".date.motionsDeadline").on("dp.change",function(){$("input.motionsDeadlineExists").prop("checked",!0).change()}),n.find(".date.amendmentDeadline").on("dp.change",function(){$("input.amendDeadlineExists").prop("checked",!0).change()}),n.find("input.minSupporters").change(function(){$("input.needsSupporters").prop("checked",!0).change()}),n.find("#siteSubdomain").on("keyup change",function(){var e=$(this),a=e.val(),t=e.parents(".subdomainRow").first(),i=e.data("query-url").replace(/SUBDOMAIN/,a),s=t.find(".subdomainError");return""==a?(s.addClass("hidden"),void t.removeClass("has-error").removeClass("has-success")):a.match(/^[A-Z0-9äöü](?:[A-Z0-9äöü_\-]{0,61}[A-Z0-9äöü])?$/i)?void $.get(i,function(a){a.available?(s.addClass("hidden"),t.removeClass("has-error"),n.find("button[type=submit]").prop("disabled",!1),a.subdomain==e.val()&&t.addClass("has-success")):(s.removeClass("hidden"),s.html(s.data("template").replace(/%SUBDOMAIN%/,a.subdomain)),t.removeClass("has-success"),a.subdomain==e.val()&&(n.find("button[type=submit]").prop("disabled",!0),t.addClass("has-error")))}):(t.removeClass("has-success").addClass("has-error"),void n.find("button[type=submit]").prop("disabled",!0))}),n.find("#siteTitle").on("keyup change",function(){$(this).val().length>=5?$(this).parents(".form-group").first().addClass("has-success"):$(this).parents(".form-group").first().removeClass("has-success")}),n.find("#siteOrganization").on("keyup change",function(){$(this).val().length>=5?$(this).parents(".form-group").first().addClass("has-success"):$(this).parents(".form-group").first().removeClass("has-success")});var a=this;n.find(".navigation .btn-next").click(function(e){"submit"!=$(this).attr("type")&&(e.preventDefault(),a.showPanel($(a.getNextPanel())))}),n.find(".navigation .btn-prev").click(function(e){e.preventDefault(),""!=window.location.hash&&window.history.back()}),n.submit(function(){}),$(window).on("hashchange",function(n){n.preventDefault();var a;a=0===parseInt(window.location.hash.substring(1))?e.firstPanel:"#panel"+window.location.hash.substring(1);var t=$(a);t.length>0&&e.showPanel(t)}),n.find(".step-pane").addClass("inactive"),this.showPanel($(this.firstPanel))},e}();
//# sourceMappingURL=SiteCreateWizard.js.map
